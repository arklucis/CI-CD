# Gitlab, Gitlab_runner запуск и первоночальная настройка

1. Запуск Gitlab и Gitlab_runner c docker-compose.yaml файла (docker-compose up -d)
2. Если на серваке где запускается есть выход в инет и в публичные репозитории (если нет смотрим след. пункт 4), то все должно работать сразу кроме tls, путь к корневому серту укажем когда будем регистрировать раннер
3. Если нет домена для Гитлаба и не собираемся его регать, то можем просто в /etc/hosts давить запись ip и его хостнейм
```
192.168.1.2 gitlab.somevm.ru
```
4. В случае если нет выхода во внешнюю сеть в инет, то нужно скачать образы (это те образы которые котрые нужны для старта Gitlab и Gitlab_runner а также для работы самого раннера)

Какие образы должны быть:

```
gitlab/gitlab-ce:latest     - образ Гитлаба
gitlab/gitlab-runner:alpine - образ раннера
ubuntu:latest               - для работы раннера
registry.gitlab.com/gitlab-org/gitlab-runner/gitlab-runner-helper:x86_64-v16.11.0 - для работы раннера
```

если их нет то качаем их с той машины где сть выход в инет (например с локальной):

```
docker pull ubuntu:latest               - Загружаем все те образы которые требуются их 4 шт.
docker save -o ubuntu.tar ubuntu:latest - Сохраняем в архив образ, далее копируем архив *.tar на удаленную тачку где будем запускать контейнеры Гитлаба
docker load -i ubuntu.tar               - На удаленной машине загружаем скопированный образ из архива
docker images                           - Проверяем должны быть все 4
```

После стартуем контейнеры из docker-compose.yaml 

## Регистрация раннера
1. При создании нового раннер в GUI Гитлаба, Гитлаб выдаст шаги которые необходимо выполнить Step1, Step2 и т.д. по сути важен только 1-й степ регистрация раннера
```
gitlab-runner register  --url https://gitlab.combined.mgts:4432  --token glrt-HP6dXqSJ_my7Z1yt-3q9 --tls-ca-file /path/to/ca.crt
```
 - *тут добавляем параметр tls с указанием пути до серта(тут поясню, корневой серт ca.crt должен уже быть в наличиисгенеренный и смонтированный в контейнере раннера он его будет испозовать при обращении к гитлабу, вольюмы уже указаны в композ файле откуда и куда монтировать, в любом случаен можете проверить смонтировался ли корневой серт в контейнере по пути который указан в композ файле), на случай если общение раннера с гитлабом будет через https, если по http то тне нужно передавать параметр tls*


2. 
